{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2>Fees & eSewa Payment</h2>
  <p>Total Paid: Rs. {{ '%.2f'|format(total_paid or 0) }}</p>

  <form method="POST" action="{{ url_for('student.esewa_pay') }}" class="mb-4">
    <div class="mb-2">
      <label class="form-label">Amount (NPR)</label>
      <input type="number" step="0.01" min="1" name="amount" class="form-control" required>
    </div>
    <button class="btn btn-success" type="submit">Pay with eSewa (Demo)</button>
  </form>

  <h4>Payment History</h4>
  <table class="table table-bordered">
    <thead><tr><th>ID</th><th>Amount</th><th>Method</th><th>Status</th><th>Reference</th><th>Date</th></tr></thead>
    <tbody>
      {% for p in payments %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.amount }}</td>
        <td>{{ p.method }}</td>
        <td>{{ p.status }}</td>
        <td>{{ p.transaction_ref or '-' }}</td>
        <td>{{ p.created_at }}</td>
      </tr>
      {% else %}
      <tr><td colspan="6">No fee payments yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
